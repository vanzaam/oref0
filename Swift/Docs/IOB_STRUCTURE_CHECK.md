# üî¥ IOB MODULE - –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê –°–¢–†–£–ö–¢–£–†–´

**–î–∞—Ç–∞**: 2025-10-07 13:16  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: ‚ö†Ô∏è –°–†–ï–î–ù–Ø–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

---

## üö® –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê!

### lib/iob/ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ö–ê–ö lib/meal/!):

```
lib/iob/
‚îú‚îÄ‚îÄ index.js (86 —Å—Ç—Ä–æ–∫) - generate() - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ history.js (~600 —Å—Ç—Ä–æ–∫) - find_insulin()
‚îú‚îÄ‚îÄ total.js (~100 —Å—Ç—Ä–æ–∫) - sum()
‚îî‚îÄ‚îÄ calculate.js (~200 —Å—Ç—Ä–æ–∫) - calculate()
```

**–ê–ù–ê–õ–û–ì–ò–ß–ù–û lib/meal/**:
```
lib/meal/
‚îú‚îÄ‚îÄ index.js - generate()
‚îú‚îÄ‚îÄ history.js - findMealInputs()
‚îî‚îÄ‚îÄ total.js - recentCarbs()
```

---

## üî¥ –¢–ï–ö–£–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê SwiftIOBAlgorithms.swift

### –ù–∞–π–¥–µ–Ω–æ "–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ":

**Line 53**:
```swift
/// –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ freeaps_iob —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ JavaScript
```

**Line 374**:
```swift
// –ò–∑ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞: rapid-acting = 75, ultra-rapid = 55
```

**–ü–†–û–ë–õ–ï–ú–ê**: –ö–æ–¥ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å –ú–ò–ù–ò–§–ò–¶–ò–†–û–í–ê–ù–ù–û–ì–û JS, –∞ –Ω–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤!

---

## üìã –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê (–∫–∞–∫ MEAL)

### –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 —Ñ–∞–π–ª–∞:

1. **SwiftIOBHistory.swift** ‚Üê lib/iob/history.js (~600 —Å—Ç—Ä–æ–∫)
   - find_insulin() —Ñ—É–Ω–∫—Ü–∏—è
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ pump history
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ treatments

2. **SwiftIOBTotal.swift** ‚Üê lib/iob/total.js (~100 —Å—Ç—Ä–æ–∫)
   - sum() —Ñ—É–Ω–∫—Ü–∏—è
   - –†–∞—Å—á–µ—Ç total IOB –¥–ª—è –º–æ–º–µ–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏

3. **SwiftIOBCalculate.swift** ‚Üê lib/iob/calculate.js (~200 —Å—Ç—Ä–æ–∫)
   - calculate() —Ñ—É–Ω–∫—Ü–∏—è
   - –†–∞—Å—á–µ—Ç IOB –¥–ª—è –æ–¥–Ω–æ–≥–æ treatment
   - Exponential –∏ bilinear –∫—Ä–∏–≤—ã–µ

4. **SwiftIOBAlgorithms.swift** (–æ–±–Ω–æ–≤–∏—Ç—å) ‚Üê lib/iob/index.js (86 —Å—Ç—Ä–æ–∫)
   - generate() —Ñ—É–Ω–∫—Ü–∏—è
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - IOB array prediction

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –ú–û–î–£–õ–ï–ô

| –ú–æ–¥—É–ª—å | –§–∞–π–ª–æ–≤ JS | –¢–µ–∫—É—â–∏–π Swift | –î–æ–ª–∂–Ω–æ –±—ã—Ç—å Swift | –°—Ç–∞—Ç—É—Å |
|--------|-----------|---------------|-------------------|--------|
| **MEAL** | 3 (index, history, total) | 3 (History, Total, Algorithms) | 3 | ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û |
| **IOB** | 4 (index, history, total, calculate) | 1 (Algorithms) | 4 | ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û |

---

## ‚úÖ –ß–¢–û –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û –í IOB

–í —Ç–µ–∫—É—â–µ–º SwiftIOBAlgorithms.swift:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ DIA (3h)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ DIA –¥–ª—è exponential curves (5h)
- ‚úÖ –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ DIA-based —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ 6h
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞

**IOB –º–æ–¥—É–ª—å –†–ê–ë–û–¢–ê–ï–¢**, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è!

---

## üéØ –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê IOB

### –≠–¢–ê–ü 1: SwiftIOBHistory.swift
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å lib/iob/history.js
- find_insulin() —Ñ—É–Ω–∫—Ü–∏—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ pump history

### –≠–¢–ê–ü 2: SwiftIOBTotal.swift
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å lib/iob/total.js
- sum() —Ñ—É–Ω–∫—Ü–∏—è
- Total IOB calculation

### –≠–¢–ê–ü 3: SwiftIOBCalculate.swift
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å lib/iob/calculate.js
- calculate() —Ñ—É–Ω–∫—Ü–∏—è
- Exponential/bilinear curves

### –≠–¢–ê–ü 4: –û–±–Ω–æ–≤–∏—Ç—å SwiftIOBAlgorithms.swift
- –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å lib/iob/index.js (generate)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –£–±—Ä–∞—Ç—å "–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ"

---

## üö® –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

**–°–†–ï–î–ù–Ø–Ø**: 
- ‚úÖ IOB –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç (5 –ø—Ä–æ–±–ª–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
- ‚ö†Ô∏è –ù–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è (1 —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ 4)
- ‚ö†Ô∏è –ö–æ–¥ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚ö†Ô∏è –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

**–ù–ï –ë–õ–û–ö–ò–†–£–ï–¢**: –ú–æ–¥—É–ª—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (—Å–ª–µ–¥—É—é—â–∞—è —Å–µ—Å—Å–∏—è):
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å autosens.js
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å profile.js
3. –ó–∞–≤–µ—Ä—à–∏—Ç—å –∞—É–¥–∏—Ç 9/9 –º–æ–¥—É–ª–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–±—É–¥—É—â–∞—è —Å–µ—Å—Å–∏—è):
4. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ IOB –º–æ–¥—É–ª—è (4 —Ñ–∞–π–ª–∞ –∫–∞–∫ MEAL)
5. –ü–æ—Ä—Ç–∞—Ü–∏—è —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö JS —Ñ–∞–π–ª–æ–≤

---

## üéØ –í–ï–†–î–ò–ö–¢

**IOB –º–æ–¥—É–ª—å**: 
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ 5 –ø—Ä–æ–±–ª–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (1 —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ 4)
- ‚ùå –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω —Å –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–∫ MEAL (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

**–î–ï–ô–°–¢–í–ò–Ø**:
- –°–Ω–∞—á–∞–ª–∞: –∑–∞–≤–µ—Ä—à–∏—Ç—å –∞—É–¥–∏—Ç (autosens, profile)
- –ü–æ—Ç–æ–º: —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ IOB (4 —Ñ–∞–π–ª–∞)
