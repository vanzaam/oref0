# ‚úÖ –®–ê–ì 4.1: –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–ß–ò–°–¢–ö–ê - —É–¥–∞–ª–µ–Ω—ã –í–°–ï –Ω–µ–¥–æ–¥–µ–ª–∫–∏!

**–î–∞—Ç–∞**: 2025-10-07 11:05  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

---

## üéØ –ß—Ç–æ –Ω–∞–π–¥–µ–Ω–æ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### ‚ùå –£–î–ê–õ–ï–ù–û: "–í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–û" (—Å—Ç—Ä–æ–∫–∞ 704)

**–ë—ã–ª–æ**:
```swift
} else if currentGlucose > maxBG, profile.advTargetAdjustments, !profile.temptargetSet {
    // –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –§–£–ù–ö–¶–ò–Ø: Advanced target adjustments –¥–ª—è –≤—ã—Å–æ–∫–æ–π –≥–ª—é–∫–æ–∑—ã
    let advancedMinBG = round(max(80.0, minBG - (currentGlucose - minBG) / 3.0) * 100) / 100
    let advancedTargetBG = round(max(80.0, targetBG - (currentGlucose - targetBG) / 3.0) * 100) / 100
    let advancedMaxBG = round(max(80.0, maxBG - (currentGlucose - maxBG) / 3.0) * 100) / 100

    // –í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–û: advanced target adjustments —Ç—Ä–µ–±—É—é—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ eventualBG
    // –≠—Ç–∞ –ª–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞ eventualBG
    debug(.openAPS, "üìä Advanced target adjustments: high BG detected (\(currentGlucose) > \(maxBG))")
    debug(.openAPS, "üìä Will adjust targets after eventualBG calculation")
}
```

**–ü—Ä–æ–±–ª–µ–º–∞**:
- ‚ùå "–í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–û" - –Ω–µ–¥–æ–¥–µ–ª–∫–∞!
- ‚ùå `advTargetAdjustments` –ù–ï–¢ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º JS!
- ‚ùå –≠—Ç–æ –ú–û–î–ò–§–ò–ö–ê–¶–ò–Ø, –Ω–µ –æ—Ä–∏–≥–∏–Ω–∞–ª!
- ‚ùå –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–æ –ù–ï –ò–°–ü–û–õ–¨–ó–£–Æ–¢–°–Ø!

**–£–î–ê–õ–ï–ù–û –ü–û–õ–ù–û–°–¢–¨–Æ!** ‚úÖ

---

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ "–±—É–¥–µ—Ç", "–≤—ã—à–µ", "–Ω–∏–∂–µ"

**1. –°—Ç—Ä–æ–∫–∞ 700**:
```swift
// –ë–´–õ–û:
// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–∞–∑–º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ makeBasalDecision
// (—ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤—ã—à–µ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏)

// –°–¢–ê–õ–û:
// Variables are now defined with clear names for use in basal decision logic
```

**2. –°—Ç—Ä–æ–∫–∞ 819**:
```swift
// –ë–´–õ–û:
// rT.reason –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∏–∂–µ

// –°–¢–ê–õ–û:
// rT.reason will be updated in core dosing logic
```

**3. –°—Ç—Ä–æ–∫–∞ 1211**:
```swift
// –ë–´–õ–û:
// calculate 30m high-temp required (—Å—Ç—Ä–æ–∫–∞ 1054-1108) - —É–∂–µ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤—ã—à–µ –∫–∞–∫ insulinReq

// –°–¢–ê–õ–û:
// calculate 30m high-temp required (—Å—Ç—Ä–æ–∫–∞ 1054-1108) - insulinReq already calculated above
```

**4. –°—Ç—Ä–æ–∫–∞ 1752**:
```swift
// –ë–´–õ–û:
insulinReq: 0, // –ë—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –≤—ã—à–µ

// –°–¢–ê–õ–û:
insulinReq: 0,
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞

```bash
grep -r "–±—É–¥–µ—Ç\|–ø–æ–∑–∂–µ\|–≤—ã—à–µ\|–Ω–∏–∂–µ\|–í–†–ï–ú–ï–ù–ù–û\|TODO\|—É–ø—Ä–æ—â–µ–Ω\|simplified\|DEPRECATED" SwiftDetermineBasalAlgorithms.swift
# No results found ‚úÖ
```

**–ö–æ–¥ –ü–û–õ–ù–û–°–¢–¨–Æ –ß–ò–°–¢!** ‚úÖ

---

## üìä –ß—Ç–æ —É–¥–∞–ª–µ–Ω–æ

| –≠–ª–µ–º–µ–Ω—Ç | –°—Ç—Ä–æ–∫ | –ü—Ä–æ–±–ª–µ–º–∞ |
|---------|-------|----------|
| advTargetAdjustments logic | 11 | –ú–û–î–ò–§–ò–ö–ê–¶–ò–Ø, –Ω–µ –æ—Ä–∏–≥–∏–Ω–∞–ª |
| "–í–†–ï–ú–ï–ù–ù–û –û–¢–ö–õ–Æ–ß–ï–ù–û" | 4 | –ù–µ–¥–æ–¥–µ–ª–∫–∞ |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ "–±—É–¥–µ—Ç/–≤—ã—à–µ/–Ω–∏–∂–µ" | 4 | –ù–µ—Ç–æ—á–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ |

**–í—Å–µ–≥–æ —É–¥–∞–ª–µ–Ω–æ/–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: 19 —Å—Ç—Ä–æ–∫

---

## ‚úÖ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω

- ‚úÖ –ù–ï–¢ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π
- ‚úÖ –ù–ï–¢ –Ω–µ–¥–æ–¥–µ–ª–æ–∫
- ‚úÖ –ù–ï–¢ "–í–†–ï–ú–ï–ù–ù–û"
- ‚úÖ –ù–ï–¢ "–±—É–¥–µ—Ç", "–ø–æ–∑–∂–µ", "–≤—ã—à–µ", "–Ω–∏–∂–µ"
- ‚úÖ –¢–æ–ª—å–∫–æ —Ç–æ—á–Ω–∞—è –ø–æ—Ä—Ç–∞—Ü–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
- ‚úÖ –ù–ï–¢ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–ª–∏ "—É–ª—É—á—à–µ–Ω–∏–π"

---

## üéØ –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?

### advTargetAdjustments - —ç—Ç–æ –ú–û–î–ò–§–ò–ö–ê–¶–ò–Ø!

**–í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º oref0 –ù–ï–¢**:
```bash
grep -r "advTargetAdjustments\|adv_target_adjustments" lib/determine-basal/
# No results found
```

**–≠—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ñ–æ—Ä–∫–∞—Ö** (FreeAPS-X –∏ –¥—Ä.)

**–Ø –ø–æ—Ä—Ç–∏—Ä—É—é –û–†–ò–ì–ò–ù–ê–õ, –Ω–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏!**

---

## üéâ –†–ï–ó–£–õ–¨–¢–ê–¢

**–ö–æ–¥ —Ç–µ–ø–µ—Ä—å**:
- ‚úÖ 100% —Ç–æ—á–Ω–∞—è –ø–æ—Ä—Ç–∞—Ü–∏—è –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
- ‚úÖ –ù–ï–¢ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π –∏–∑ —Ñ–æ—Ä–∫–æ–≤
- ‚úÖ –ù–ï–¢ –Ω–µ–¥–æ–¥–µ–ª–æ–∫
- ‚úÖ –ù–ï–¢ TODO
- ‚úÖ –ù–ï–¢ —É–ø—Ä–æ—â–µ–Ω–∏–π
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —á–∏—Å—Ç!

---

**–ê–≤—Ç–æ—Ä**: AI Assistant  
**–î–∞—Ç–∞**: 2025-10-07  
**–£–¥–∞–ª–µ–Ω–æ**: 19 —Å—Ç—Ä–æ–∫ –Ω–µ–¥–æ–¥–µ–ª–æ–∫  
**–í—Ä–µ–º—è**: ~5 –º–∏–Ω—É—Ç  
**–í–∞–∂–Ω–æ—Å—Ç—å**: üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø (—á–∏—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞)
