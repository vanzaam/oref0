# üéØ –ü–õ–ê–ù –ù–û–†–ú–ê–õ–¨–ù–û–ô –ü–û–†–¢–ê–¶–ò–ò OREF0 ‚Üí SWIFT

**–î–∞—Ç–∞**: 2025-10-07  
**–¶–µ–ª—å**: –°–æ–∑–¥–∞—Ç—å **—Ç–æ—á–Ω—É—é, —Ä–∞–±–æ—Ç–∞—é—â—É—é** Swift-–ø–æ—Ä—Ç–∞—Ü–∏—é oref0 –±–µ–∑ –ø–æ—Ç–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

## üìã –≠–¢–ê–ü 1: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –û–®–ò–ë–û–ö (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### ‚úÖ –®–∞–≥ 1.1: –î–æ–±–∞–≤–∏—Ç—å `outUnits` –≤ ProfileResult
**–§–∞–π–ª**: `Swift/SwiftProfileAlgorithms.swift`

```swift
struct ProfileResult {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
    let outUnits: String  // "mg/dL" –∏–ª–∏ "mmol/L"
}
```

**–í—Ä–µ–º—è**: 15 –º–∏–Ω—É—Ç  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Unit test –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è

---

### ‚úÖ –®–∞–≥ 1.2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `convertBG`
**–§–∞–π–ª**: `Swift/SwiftDetermineBasalAlgorithms.swift`

```swift
/// –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ determine-basal.js:39-49
/// –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≥–ª—é–∫–æ–∑—ã –º–µ–∂–¥—É mg/dL –∏ mmol/L
private static func convertBG(_ value: Double, profile: ProfileResult) -> Double {
    if profile.outUnits == "mmol/L" {
        return round(value / 18.0 * 10) / 10  // round to 1 decimal
    } else {
        return round(value)  // round to integer
    }
}
```

**–í—Ä–µ–º—è**: 10 –º–∏–Ω—É—Ç  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: 
- `convertBG(120, mg/dL) == 120`
- `convertBG(120, mmol/L) == 6.7`

---

### ‚úÖ –®–∞–≥ 1.3: –î–æ–±–∞–≤–∏—Ç—å `profile` –≤ DetermineBasalResult
**–ü—Ä–æ–±–ª–µ–º–∞**: –î–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ `rawJSON` –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ `profile.outUnits`

```swift
struct DetermineBasalResult {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
    let profile: ProfileResult  // –î–æ–±–∞–≤–ª—è–µ–º –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ outUnits
}
```

**–í—Ä–µ–º—è**: 20 –º–∏–Ω—É—Ç  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –≤—ã–∑–æ–≤—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

### ‚úÖ –®–∞–≥ 1.4: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ BG-–∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
**–§–∞–π–ª**: `Swift/SwiftDetermineBasalAlgorithms.swift`

**–ú–µ—Å—Ç–∞ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
1. `DetermineBasalResult.rawJSON` - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `bg`, `eventualBG`
2. –í—Å–µ —Å—Ç—Ä–æ–∫–∏ `reason` - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ BG-–∑–Ω–∞—á–µ–Ω–∏—è
3. `predBGs` –º–∞—Å—Å–∏–≤—ã - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç
4. –ü–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: `BGI`, `deviation`, `ISF`, `target_bg`

**–í—Ä–µ–º—è**: 2 —á–∞—Å–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç Swift vs JS –¥–ª—è mmol/L

---

## üìã –≠–¢–ê–ü 2: –ü–û–õ–ù–ê–Ø –ü–û–†–¢–ê–¶–ò–Ø DETERMINE-BASAL (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### ‚úÖ –®–∞–≥ 2.1: –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**–ò–∑ determine-basal.js –Ω—É–∂–Ω–æ –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å**:

1. **`round(value, digits)`** (—Å—Ç—Ä–æ–∫–∞ 21-26)
   ```swift
   private static func round(_ value: Double, digits: Int = 0) -> Double {
       let scale = pow(10.0, Double(digits))
       return Darwin.round(value * scale) / scale
   }
   ```

2. **`calculate_expected_delta(target_bg, eventual_bg, bgi)`** (—Å—Ç—Ä–æ–∫–∞ 31-36)
   ```swift
   private static func calculateExpectedDelta(
       targetBG: Double, 
       eventualBG: Double, 
       bgi: Double
   ) -> Double {
       let fiveMinBlocks = (2.0 * 60.0) / 5.0  // 24 blocks in 2 hours
       let targetDelta = targetBG - eventualBG
       return round(bgi + (targetDelta / fiveMinBlocks), digits: 1)
   }
   ```

3. **`enable_smb(...)`** (—Å—Ç—Ä–æ–∫–∞ 51-125) - –ü–û–õ–ù–ê–Ø –ª–æ–≥–∏–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è SMB
4. **`setTempBasal(...)`** - –ª–æ–≥–∏–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ temp basal
5. **–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ CGM** (—Å—Ç—Ä–æ–∫–∞ 149-221)

**–í—Ä–µ–º—è**: 4 —á–∞—Å–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Unit tests –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

---

### ‚úÖ –®–∞–≥ 2.2: –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º determine_basal

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏ –¥–ª—è –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:

1. **CGM Safety Checks** (—Å—Ç—Ä–æ–∫–∞ 149-221)
   - –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ / ??? state: `glucose <= 10 || glucose === 38 || noise >= 3`
   - –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ: `glucose_age > 12 || glucose_age < -5`
   - –ó–∞—Å—Ç—Ä—è–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ: `delta === 0 && short_avgdelta > -1 && short_avgdelta < 1`

2. **Temp Basal Safety** (—Å—Ç—Ä–æ–∫–∞ 188-221)
   - –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ temp: `currenttemp.rate !== lastTemp.rate && lastTempAge > 10`
   - –ò—Å—Ç–µ–∫—à–∏–π temp: `tempAge - tempDuration > 5 && lastTempAge > 10`

3. **Target BG Calculation** (—Å—Ç—Ä–æ–∫–∞ 223-247)
   - `target_bg = (profile.min_bg + profile.max_bg) / 2`

4. **Sensitivity Ratio** (—Å—Ç—Ä–æ–∫–∞ 249-290)
   - Temp target adjustments
   - Autosens ratio
   - Basal adjustments

5. **Target BG Adjustments** (—Å—Ç—Ä–æ–∫–∞ 292-326)
   - Autosens adjustments
   - Noisy CGM target multiplier

6. **ISF Adjustments** (—Å—Ç—Ä–æ–∫–∞ 335-348)
   - `sens = profile.sens / sensitivityRatio`

7. **BGI & Deviation** (—Å—Ç—Ä–æ–∫–∞ 399-417)
   - `bgi = round((-iob_data.activity * sens * 5), 2)`
   - `deviation = round((30 / 5) * (minDelta - bgi), 2)`

8. **Prediction Arrays** (—Å—Ç—Ä–æ–∫–∞ 442-657)
   - IOBpredBGs, COBpredBGs, UAMpredBGs, ZTpredBGs

9. **Eventual BG** (—Å—Ç—Ä–æ–∫–∞ 417)
   - `eventualBG = naive_eventualBG + deviation`

10. **SMB Logic** (—Å—Ç—Ä–æ–∫–∞ 659-1170)
    - Enable/disable SMB
    - Calculate microbolus
    - Safety limits

11. **Carbs Required** (—Å—Ç—Ä–æ–∫–∞ 882-905)
    - `carbsReq = (bgUndershoot - zeroTempEffect) / csf - COBforCarbsReq`

12. **Low Glucose Suspend** (—Å—Ç—Ä–æ–∫–∞ 907-927)
    - `bg < threshold || minGuardBG < threshold`

13. **Temp Basal Recommendations** (—Å—Ç—Ä–æ–∫–∞ 930-1170)
    - High/low temp logic
    - Rate calculations
    - Duration calculations

**–í—Ä–µ–º—è**: 8 —á–∞—Å–æ–≤  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üìã –≠–¢–ê–ü 3: –ü–û–†–¢–ê–¶–ò–Ø IOB CALCULATION (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### ‚úÖ –®–∞–≥ 3.1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å bilinear curve

**–§–∞–π–ª**: `Swift/SwiftOpenAPSAlgorithms.swift`

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å** `lib/iob/calculate.js:36-80`:
- `peak = 75` –º–∏–Ω—É—Ç
- `end = 180` –º–∏–Ω—É—Ç
- `activityPeak = 2 / (dia * 60)`
- –§–æ—Ä–º—É–ª—ã –¥–ª—è `activityContrib` –∏ `iobContrib`

**–í—Ä–µ–º—è**: 1 —á–∞—Å  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å JS –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –±–æ–ª—é—Å–æ–≤

---

### ‚úÖ –®–∞–≥ 3.2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å exponential curve

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å** `lib/iob/calculate.js:83-147`:
- Peak times: rapid-acting = 75, ultra-rapid = 55
- –§–æ—Ä–º—É–ª—ã tau, a, S
- `activityContrib` –∏ `iobContrib` —Ñ–æ—Ä–º—É–ª—ã

**–í—Ä–µ–º—è**: 1 —á–∞—Å  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏—Ç—å —Å JS –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏–Ω—Å—É–ª–∏–Ω–∞

---

## üìã –≠–¢–ê–ü 4: –ü–û–†–¢–ê–¶–ò–Ø PROFILE (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

### ‚úÖ –®–∞–≥ 4.1: –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –ø–æ–ª—è –∏–∑ profile/index.js

**–§–∞–π–ª**: `Swift/SwiftProfileAlgorithms.swift`

**–ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–æ–ª—è**:
```swift
struct ProfileResult {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    
    // –ò–∑ profile/index.js:153-189
    let outUnits: String
    let minBG: Double
    let maxBG: Double
    let bgTargets: BGTargets
    let temptargetSet: Bool
    let isfProfile: InsulinSensitivities
    
    // SMB –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å—Ç—Ä–æ–∫–∞ 60-100 –≤ profile/index.js)
    let enableSMBAlways: Bool
    let enableSMBWithCOB: Bool
    let enableSMBWithTemptarget: Bool
    let enableSMBAfterCarbs: Bool
    let allowSMBWithHighTemptarget: Bool
    let maxSMBBasalMinutes: Double
    let maxUAMSMBBasalMinutes: Double
    let SMBInterval: Double
    
    // Safety –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    let carbsReqThreshold: Double
    let noisyCGMTargetMultiplier: Double
    let maxRaw: Double
    let a52RiskEnable: Bool
    
    // Autosens –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    let autosensMax: Double
    let autosensMin: Double
    let sensitivityRaisesTarget: Bool
    let resistanceLowersTarget: Bool
}
```

**–í—Ä–µ–º—è**: 2 —á–∞—Å–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏

---

## üìã –≠–¢–ê–ü 5: –ü–û–†–¢–ê–¶–ò–Ø MEAL/COB (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

### ‚úÖ –®–∞–≥ 5.1: –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å meal/total.js

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
1. **Carb absorption model** (—Å—Ç—Ä–æ–∫–∞ 30-150)
   - `carbWindow = 6` —á–∞—Å–æ–≤
   - –ú–æ–¥–µ–ª—å –∞–±—Å–æ—Ä–±—Ü–∏–∏ —É–≥–ª–µ–≤–æ–¥–æ–≤
   - COB calculation

2. **Carb impact** (—Å—Ç—Ä–æ–∫–∞ 150-200)
   - `ci = (minDelta - bgi) / sens * 5`
   - Carb sensitivity factor

**–í—Ä–µ–º—è**: 3 —á–∞—Å–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏—Ç—å COB —Å JS –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏

---

## üìã –≠–¢–ê–ü 6: –ü–û–†–¢–ê–¶–ò–Ø AUTOSENS (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)

### ‚úÖ –®–∞–≥ 6.1: –ü–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å autosens/index.js

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏**:
1. **Deviation analysis** (—Å—Ç—Ä–æ–∫–∞ 50-200)
   - –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π BGI vs —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤ (CSF, UAM, high_cob)

2. **Ratio calculation** (—Å—Ç—Ä–æ–∫–∞ 200-300)
   - `ratio = 1.0 + (avgDeviation / sensitivityThreshold)`
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è autosens_min/max

**–í—Ä–µ–º—è**: 4 —á–∞—Å–∞  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°—Ä–∞–≤–Ω–∏—Ç—å ratio —Å JS –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìã –≠–¢–ê–ü 7: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

### ‚úÖ –®–∞–≥ 7.1: Unit Tests

**–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è**:
1. `convertBG` - mg/dL ‚Üî mmol/L
2. `round` - –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Å —Ä–∞–∑–Ω—ã–º–∏ digits
3. `calculateExpectedDelta`
4. `enable_smb` - –≤—Å–µ —É—Å–ª–æ–≤–∏—è
5. IOB calculation - bilinear –∏ exponential
6. Profile creation - –≤—Å–µ –ø–æ–ª—è
7. Meal/COB calculation
8. Autosens calculation

**–í—Ä–µ–º—è**: 4 —á–∞—Å–∞

---

### ‚úÖ –®–∞–≥ 7.2: Integration Tests

**–¢–µ—Å—Ç-–∫–µ–π—Å—ã**:
1. **–ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π**: BG = 120, COB = 30, IOB = 2
2. **–ù–∏–∑–∫–∏–π BG**: BG = 70, suspend insulin
3. **–í—ã—Å–æ–∫–∏–π BG**: BG = 200, high temp + SMB
4. **mmol/L –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
5. **Noisy CGM**: target adjustments
6. **Temp target**: sensitivity adjustments
7. **Autosens**: ratio –ø—Ä–∏–º–µ–Ω–µ–Ω –∫ basal –∏ ISF

**–í—Ä–µ–º—è**: 6 —á–∞—Å–æ–≤

---

### ‚úÖ –®–∞–≥ 7.3: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Swift vs JS

**–ú–µ—Ç–æ–¥**:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
3. –î–æ–ø—É—Å—Ç–∏–º–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å: 0.01 –¥–ª—è –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–¢–µ—Å—Ç-–¥–∞–Ω–Ω—ã–µ**:
- 100 —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏–∑ production
- –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö edge cases
- mg/dL –∏ mmol/L –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**–í—Ä–µ–º—è**: 8 —á–∞—Å–æ–≤

---

## üìã –≠–¢–ê–ü 8: –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)

### ‚úÖ –®–∞–≥ 8.1: –û–±–Ω–æ–≤–∏—Ç—å CRITICAL_SAFETY_README.md

**–î–æ–±–∞–≤–∏—Ç—å**:
- ‚úÖ –°—Ç–∞—Ç—É—Å –ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç JS (–µ—Å–ª–∏ –µ—Å—Ç—å)

**–í—Ä–µ–º—è**: 2 —á–∞—Å–∞

---

### ‚úÖ –®–∞–≥ 8.2: –°–æ–∑–¥–∞—Ç—å Migration Guide

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤**:
- –ö–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è —Å JS –Ω–∞ Swift
- –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–í—Ä–µ–º—è**: 2 —á–∞—Å–∞

---

## üìä –û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê –í–†–ï–ú–ï–ù–ò

| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|------|-------|-----------|
| 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ | 3 —á–∞—Å–∞ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| 2. –ü–æ–ª–Ω–∞—è –ø–æ—Ä—Ç–∞—Ü–∏—è determine-basal | 12 —á–∞—Å–æ–≤ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| 3. –ü–æ—Ä—Ç–∞—Ü–∏—è IOB | 2 —á–∞—Å–∞ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| 4. –ü–æ—Ä—Ç–∞—Ü–∏—è Profile | 2 —á–∞—Å–∞ | üü° –í—ã—Å–æ–∫–∏–π |
| 5. –ü–æ—Ä—Ç–∞—Ü–∏—è Meal/COB | 3 —á–∞—Å–∞ | üü° –í—ã—Å–æ–∫–∏–π |
| 6. –ü–æ—Ä—Ç–∞—Ü–∏—è Autosens | 4 —á–∞—Å–∞ | üü° –í—ã—Å–æ–∫–∏–π |
| 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 18 —á–∞—Å–æ–≤ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π |
| 8. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 4 —á–∞—Å–∞ | üü¢ –°—Ä–µ–¥–Ω–∏–π |
| **–ò–¢–û–ì–û** | **48 —á–∞—Å–æ–≤** | |

---

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (MVP)
1. ‚úÖ –§—É–Ω–∫—Ü–∏—è `convertBG` —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è mg/dL –∏ mmol/L
2. ‚úÖ –í—Å–µ BG-–∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
3. ‚úÖ CGM safety checks —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ JS
4. ‚úÖ Temp basal recommendations —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å JS (¬±0.01)
5. ‚úÖ IOB calculation —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å JS (¬±0.001)

### ‚úÖ –ü–æ–ª–Ω–∞—è –ø–æ—Ä—Ç–∞—Ü–∏—è
6. ‚úÖ SMB logic —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ JS
7. ‚úÖ Prediction arrays —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å JS
8. ‚úÖ Autosens ratio —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å JS (¬±0.01)
9. ‚úÖ COB calculation —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å JS (¬±0.1g)
10. ‚úÖ –í—Å–µ edge cases –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã

### ‚úÖ Production Ready
11. ‚úÖ 100% –ø–æ–∫—Ä—ã—Ç–∏–µ unit tests
12. ‚úÖ 100 integration tests passed
13. ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 99%+ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å JS
14. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
15. ‚úÖ Code review –ø—Ä–æ–π–¥–µ–Ω

---

## üöÄ –ü–û–†–Ø–î–û–ö –í–´–ü–û–õ–ù–ï–ù–ò–Ø

### –ù–µ–¥–µ–ª—è 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –î–µ–Ω—å 1-2: –≠—Ç–∞–ø 1 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏)
- –î–µ–Ω—å 3-5: –≠—Ç–∞–ø 2 (determine-basal, —á–∞—Å—Ç—å 1)

### –ù–µ–¥–µ–ª—è 2: –û—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º
- –î–µ–Ω—å 1-3: –≠—Ç–∞–ø 2 (determine-basal, —á–∞—Å—Ç—å 2)
- –î–µ–Ω—å 4-5: –≠—Ç–∞–ø 3 (IOB)

### –ù–µ–¥–µ–ª—è 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- –î–µ–Ω—å 1-2: –≠—Ç–∞–ø 4 (Profile)
- –î–µ–Ω—å 3: –≠—Ç–∞–ø 5 (Meal/COB)
- –î–µ–Ω—å 4-5: –≠—Ç–∞–ø 6 (Autosens)

### –ù–µ–¥–µ–ª—è 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –î–µ–Ω—å 1-2: –≠—Ç–∞–ø 7.1 (Unit tests)
- –î–µ–Ω—å 3-4: –≠—Ç–∞–ø 7.2-7.3 (Integration + —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ)
- –î–µ–Ω—å 5: –≠—Ç–∞–ø 8 (–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

---

## üìù –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –ö–û–ú–ú–ò–¢–û–ú

- [ ] –í—Å–µ unit tests –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: >95% —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- [ ] SwiftLint warnings –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] CRITICAL_SAFETY_README.md –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üÜò –†–ò–°–ö–ò –ò –ú–ò–¢–ò–ì–ê–¶–ò–Ø

### –†–∏—Å–∫ 1: –ù–µ—Ç–æ—á–Ω–∞—è –ø–æ—Ä—Ç–∞—Ü–∏—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å JS

### –†–∏—Å–∫ 2: –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ edge cases
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–π –≤ JS –∫–æ–¥–µ, 100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### –†–∏—Å–∫ 3: –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏

### –†–∏—Å–∫ 4: –†–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ production
**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π rollout, feature flag –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è JS‚ÜîSwift

---

**–ù–∞—á–∏–Ω–∞–µ–º —Å –≠—Ç–∞–ø–∞ 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫** üöÄ
